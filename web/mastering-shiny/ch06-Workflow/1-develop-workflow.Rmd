# 工作流（一）开发工作流

工作流系列将向读者介绍如何提升 3 个重要的 Shiny 工作流：

- 创建应用，进行更改并尝试结果的基本开发周期。
- 调试，找出代码出了什么问题的技巧，并集思广益地解决该问题。
- 编写 reprexes，这些独立的代码段说明了问题。 Reprexes是一种强大的调试技术，如果你想从别人那里获得帮助，它们是必不可少的。


首先我们将学习开发工作流。

优化开发工作流程的目标是减少做出更改和看到结果之间的时间。迭代的速度越快，你可以进行的实验就越快，你就可以成为一名更好的 Shiny 开发人员。这里有两个主要的工作流程需要优化：第一次创建应用程序，以及加快代码调整和试验结果的迭代周期。

## 创建 Shiny 应用

我们基本上使用相同的六行 R 代码启动每个应用程序：

```r
library(shiny)
ui <- fluidPage(
)
server <- function(input, output, session) {
}
shinyApp(ui, server)
```

你可能很快就厌倦了键入该代码，因此 RStudio 提供了一些快捷方式：

- 如果你已经打开了要使用的 app.R，请键入 `shinyapp`，然后按 Shift + Tab 插入 Shiny 应用程序片段。
- 如果要启动新项目，请转到“文件”菜单，选择“新建项目”，然后选择“Shiny 的 Web 应用程序”：


![](https://d33wubrfki0l68.cloudfront.net/584ffe96449eec9e0c6656109ffa5db83e030b80/6d1fb/screenshots/action-workflow/new-project.png)

读者可能认为学习这些快捷方式不值得，因为你每天只会创建一两个应用程序，但是创建简单的应用程序是在开始较大项目之前检查基本概念的好方法，它们是调试的绝佳工具。

## 查看你的更改

可能你每天只创建几个应用程序，但你将运行数百次应用程序，因此掌握开发工作流程尤为重要。降低迭代速度的第一种方法是避免单击“运行应用程序”按钮，而是学习键盘快捷键Cmd/Ctrl + Shift + Enter。这为你提供了以下开发工作流程：

1. 编写一些代码。
2. 使用快捷键启动应用程序。
3. 交互式地测试应用。
4. 关闭应用。
5. 回到第 1 步。

进一步降低迭代速度的另一种方法是打开自动重新加载（`options(shiny.autoreload = TRUE)`），然后在后台作业中运行该应用，使用此工作流程，保存文件后，您的应用将重新启动：无需关闭并重新启动。这将导致更快的工作流程：

1. 编写代码并运行保存快捷键保存文件。
2. 交互式地测试应用。
3. 回到第 1 步。

具体使用方法见 <https://github.com/sol-eng/background-jobs/tree/master/shiny-job>。

这种技术的主要缺点是，由于应用程序是在单独的进程中运行的，因此调试起来相当困难。

随着你的应用程序变得越来越大，你会发现“交互式实验”步骤开始变得繁重。很难记住要重新检查应用程序中可能受更改影响的每个组件。在后面的文章中，我们将学习自动测试的工具，该工具可让我们将正在运行的交互式实验转换为自动代码。这使我们可以更快地运行测试（因为它们是自动化的），这意味着我们不能忘记运行重要的测试。开发测试需要一些初期投资，但是对于大型应用程序来说，这些投入是值得的。


## 控制视图

默认情况下，运行该应用程序时，它将显示在弹出窗口中。我们可以从“运行应用程序”下拉菜单中选择其他两个选项：

![](https://d33wubrfki0l68.cloudfront.net/acd34c85f0713f5e4a44a1607420ec6900404505/f6284/images/basic-app/run-app-details.png)

- 在查看器窗格中运行对于较小的应用程序很有用，因为你可以在运行应用程序代码的同时看到它。
- 在外部浏览器中运行对于大型应用程序很有用，或者如果你要检查应用程序的外观是否与大多数用户看到的情况完全相同。

